"use strict";(self["webpackChunkvue_system"]=self["webpackChunkvue_system"]||[]).push([[496],{9109:function(e,t,a){a.d(t,{Z:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"add"==e.type?"添加规格":"编辑规格",visible:e.dialogFormVisible,center:"",width:"70%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"规格ID",prop:"cid"}},[t("el-input",{attrs:{disabled:e.unchangable},model:{value:e.ruleForm.cid,callback:function(t){e.$set(e.ruleForm,"cid",t)},expression:"ruleForm.cid"}})],1),t("el-form-item",{attrs:{label:"类目ID",prop:"id"}},[t("el-input",{model:{value:e.ruleForm.id,callback:function(t){e.$set(e.ruleForm,"id",t)},expression:"ruleForm.id"}})],1),t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"规格设置",prop:"rule"}},[t("WangEditor",{ref:"rule",attrs:{desc:e.ruleForm.rule}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.resetForm()}}},[e._v("重置 ")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("确 定")])],1)],1)},l=[],i=a(3468),s={name:"Dialog",components:{WangEditor:i.Z},data(){return{dialogFormVisible:!1,type:"add",ruleForm:{id:"",cid:"",name:"",rule:""},rules:{name:[{required:!0,message:"请输入类目名称",trigger:"blur"}],cid:[{required:!0,message:"请输入规格ID",trigger:"blur"}],id:[{required:!0,message:"请输入类目ID",trigger:"blur"}]}}},computed:{unchangable(){return"edit"==this.type}},mounted(){this.$bus.$on("openRuleDialog",((e,t={})=>{this.dialogFormVisible=!0,this.resetForm(),this.type=e,"edit"==this.type&&(this.ruleForm=t,console.log(this.ruleForm))}))},methods:{submitForm(){this.ruleForm.rule=this.$refs.rule.editor.txt.text(),this.$refs["ruleForm"].validate((async e=>{if(!e)return this.$message({showClose:!0,message:"请按要求输入",type:"error"}),!1;"add"==this.type?await this.$store.dispatch("addRule",this.ruleForm).then((e=>{e&&(this.dialogFormVisible=!1,this.$router.go(0),this.resetForm())})):await this.$store.dispatch("updateRules",this.ruleForm).then((e=>{this.dialogFormVisible=!1,this.$router.go(0),this.resetForm(),this.type="add"}))}))},resetForm(){this.ruleForm={id:"",cid:"",name:"",rule:""},this.$bus.$emit("clear")}}},o=s,n=a(1001),u=(0,n.Z)(o,r,l,!1,null,null,null),d=u.exports},8618:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"rule"}},[t("div",{staticClass:"search"},[t("el-input",{attrs:{placeholder:"输入关键字进行搜索……"},on:{change:e.goSearch},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"}},[e._v(e._s(e.$t("content.search")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.addCategory}},[e._v("添加规格")])],1),t("main",[t("el-table",{ref:"tables",attrs:{data:e.tableData,border:"",align:"center","header-align":"center"}},[t("el-table-column",{attrs:{prop:"cid",label:"规格CID",width:"80"}}),t("el-table-column",{attrs:{prop:"id",label:"类目ID",width:"80"}}),t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"rule",label:"规格设置"}}),t("el-table-column",{staticClass:"buttonss",attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"edit",attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("编辑")]),t("el-button",{staticClass:"edit",attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除")])]}}])})],1)],1),t("RuleDialog"),t("div",{staticClass:"toolbar"},[t("Excel",{staticClass:"excel",attrs:{formTitle:"类目",field:e.json_fields,formData:e.allData,name:"商品类目"}}),t("TXT",{attrs:{txtHeadTitle:e.txtHeadTitle,name:"所有类目",txtData:e.allData}}),t("el-button",{attrs:{type:"success"},on:{click:e.pdf}},[e._v("导出为pdf文件")]),t("PDF")],1),t("Pagination",{attrs:{total:e.total,pageSize:e.pageSize,pageNo:e.pageNo,currentPage:e.currentPage},on:{changePageSize:e.RulePageSize,changePageNo:e.RulePageNo}})],1)},l=[],i=a(8133),s=a(7758),o=a(1659),n=a(9109),u=a(4199),d=a(3822),c={name:"Rule",components:{Pagination:i.Z,Excel:o.Z,TXT:s.Z,RuleDialog:n.Z,PDF:u.Z},data(){return{tableData:[],keyword:"",pageNo:1,pageSize:4,total:0,currentPage:1,type:"all",json_fields:{"规格ID":"cid","类目ID":"id","名称":"name","规格设置":"rule"}}},created(){this.getData()},computed:{...(0,d.rn)({ruleData:e=>e.params.ruleData,allData:e=>e.params.allData,searchData:e=>e.params.searchData}),txtHeadTitle(){return Object.keys(this.json_fields).join(" ")}},methods:{getData(e=1,t=4){this.$store.dispatch("getCategory",{pageNo:e,pageSize:t}).then((e=>{e.success&&(this.pageNo=parseInt(e.pageNo),this.pageSize=parseInt(e.pageSize),this.total=e.total,this.currentPage=this.pageNo,this.tableData=this.ruleData,this.type="all")}))},goSearch(){if(!this.keyword.trim())return!1;this.$store.dispatch("searchRules",{keyword:this.keyword.trim()}).then((e=>{this.total=e.total,this.type="search",this.pageSize=4,this.pageNo=1,this.RulePageNo(1,4)}))},RulePageSize(e,t){if(this.currentPage=1,"all"==this.type)this.getData(1,e);else{if(!(this.searchData.length>e))return;this.tableData=this.searchData.slice((t-1)*e,t*e)}},RulePageNo(e,t){this.currentPage=e,"all"==this.type?this.getData(e,t):this.tableData=this.searchData.slice((e-1)*t,e*t)},addCategory(){this.$bus.$emit("openRuleDialog","add")},handleEdit(e,t){this.$bus.$emit("openRuleDialog","edit",t)},handleDelete(e,t){this.$store.dispatch("deleteRule",{cid:t.cid}).then((()=>{this.getData()}))},pdf(){this.$bus.$emit("pdf")}}},h=c,m=a(1001),p=(0,m.Z)(h,r,l,!1,null,"7c7dc7b7",null),g=p.exports}}]);